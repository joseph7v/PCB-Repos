/*
 * ax5043.h
 *
 *  Created on: 28 мар. 2018 г.
 *      Author: lema
 */

#ifndef AXRADIO_AX5043_H_
#define AXRADIO_AX5043_H_
#include <stdint.h>
enum ax5043_reg_t
{
	//	Revision & Interface Probing
	AX5043_REVISION = 0x0000,
	AX5043_SCRATCH,
	//	Operating Mode
	AX5043_PWRMODE = 0x0002,
	//	Voltage Regulator
	AX5043_POWSTAT = 0x0003,
	AX5043_POWSTICKYSTAT,
	AX5043_POWIRQMASK,
	//	Interrupt Control
	AX5043_IRQMASK1 = 0x0006,
	AX5043_IRQMASK0,
	AX5043_RADIOEVENTMASK1,
	AX5043_RADIOEVENTMASK0,
	AX5043_IRQINVERSION1,
	AX5043_IRQINVERSION0,
	AX5043_IRQREQUEST1,
	AX5043_IRQREQUEST0,
	AX5043_RADIOEVENTREQ1,
	AX5043_RADIOEVENTREQ0,
	//	Modulation & Framing
	AX5043_MODULATION = 0x0010,
	AX5043_ENCODING,
	AX5043_FRAMING,
	AX5043_CRCINIT3 = 0x0014,
	AX5043_CRCINIT2,
	AX5043_CRCINIT1,
	AX5043_CRCINIT0,
	//	Forward Error Correction
	AX5043_FEC = 0x0018,
	AX5043_FECSYNC,
	AX5043_FECSTATUS,
	//	Status
	AX5043_RADIOSTATE = 0x001C,
	AX5043_XTALSTATUS,
	//	Pin Configuration
	AX5043_PINSTATE = 0x0020,
	AX5043_PINFUNCSYSCLK,
	AX5043_PINFUNCDCLK,
	AX5043_PINFUNCDATA,
	AX5043_PINFUNCIRQ,
	AX5043_PINFUNCANTSEL,
	AX5043_PINFUNCPWRAMP,
	AX5043_PWRAMP,
	//	FIFO
	AX5043_FIFOSTAT = 0x0028,
	AX5043_FIFODATA,
	AX5043_FIFOCOUNT1,
	AX5043_FIFOCOUNT0,
	AX5043_FIFOFREE1,
	AX5043_FIFOFREE0,
	AX5043_FIFOTHRESH1,
	AX5043_FIFOTHRESH0,
	//	Synthesizer
	AX5043_PLLLOOP = 0x0030,
	AX5043_PLLCPI,
	AX5043_PLLVCODIV,
	AX5043_PLLRANGINGA,
	AX5043_FREQA3,
	AX5043_FREQA2,
	AX5043_FREQA1,
	AX5043_FREQA0,
	AX5043_PLLLOOPBOOST,
	AX5043_PLLCPIBOOST,
	AX5043_PLLRANGINGB = 0x003B,
	AX5043_FREQB3,
	AX5043_FREQB2,
	AX5043_FREQB1,
	AX5043_FREQB0,
	//	Signal Strength
	AX5043_RSSI = 0x0040,
	AX5043_BGNDRSSI,
	AX5043_DIVERSITY,
	AX5043_AGCCOUNTER,
	//	Receiver Tracking
	AX5043_TRKDATARATE2 = 0x0045,
	AX5043_TRKDATARATE1,
	AX5043_TRKDATARATE0,
	AX5043_TRKAMPL1,
	AX5043_TRKAMPL0,
	AX5043_TRKPHASE1,
	AX5043_TRKPHASE0,
	AX5043_TRKRFFREQ2 = 0x004D,
	AX5043_TRKRFFREQ1,
	AX5043_TRKRFFREQ0,
	AX5043_TRKFREQ1,
	AX5043_TRKFREQ0,
	AX5043_TRKFSKDEMOD1,
	AX5043_TRKFSKDEMOD0,
	AX5043_TRKAFSKDEMOD1,
	AX5043_TRKAFSKDEMOD0,
	//	Timer
	AX5043_TIMER2 = 0x0059,
	AX5043_TIMER1,
	AX5043_TIMER0,
	//	Wakeup Timer
	AX5043_WAKEUPTIMER1= 0x0068,
	AX5043_WAKEUPTIMER0,
	AX5043_WAKEUP1,
	AX5043_WAKEUP0,
	AX5043_WAKEUPFREQ1,
	AX5043_WAKEUPFREQ0,
	AX5043_WAKEUPXOEARLY,
	//	Physical Layer Parameters
	//	Receiver Parameters
	AX5043_IFFREQ1 = 0x0100,
	AX5043_IFFREQ0,
	AX5043_DECIMATION,
	AX5043_RXDATARATE2,
	AX5043_RXDATARATE1,
	AX5043_RXDATARATE0,
	AX5043_MAXDROFFSET2,
	AX5043_MAXDROFFSET1,
	AX5043_MAXDROFFSET0,
	AX5043_MAXRFOFFSET2,
	AX5043_MAXRFOFFSET1,
	AX5043_MAXRFOFFSET0,
	AX5043_FSKDMAX1,
	AX5043_FSKDMAX0,
	AX5043_FSKDMIN1,
	AX5043_FSKDMIN0,
	AX5043_AFSKSPACE1,
	AX5043_AFSKSPACE0,
	AX5043_AFSKMARK1,
	AX5043_AFSKMARK0,
	AX5043_AFSKCTRL,
	AX5043_AMPLFILTER,
	AX5043_FREQUENCYLEAK,
	AX5043_RXPARAMSETS,
	AX5043_RXPARAMCURSET,
	//	Receiver Parameter Set 0
	AX5043_AGCGAIN0 = 0x0120,
	AX5043_AGCTARGET0,
	AX5043_AGCAHYST0,
	AX5043_AGCMINMAX0,
	AX5043_TIMEGAIN0,
	AX5043_DRGAIN0,
	AX5043_PHASEGAIN0,
	AX5043_FREQUENCYGAINA0,
	AX5043_FREQUENCYGAINB0,
	AX5043_FREQUENCYGAINC0,
	AX5043_FREQUENCYGAIND0,
	AX5043_AMPLITUDEGAIN0,
	AX5043_FREQDEV10,
	AX5043_FREQDEV00,
	AX5043_FOURFSK0,
	AX5043_BBOFFSRES0,
	//	Receiver Parameter Set 1
	AX5043_AGCGAIN1 = 0x0130,
	AX5043_AGCTARGET1,
	AX5043_AGCAHYST1,
	AX5043_AGCMINMAX1,
	AX5043_TIMEGAIN1,
	AX5043_DRGAIN1,
	AX5043_PHASEGAIN1,
	AX5043_FREQUENCYGAINA1,
	AX5043_FREQUENCYGAINB1,
	AX5043_FREQUENCYGAINC1,
	AX5043_FREQUENCYGAIND1,
	AX5043_AMPLITUDEGAIN1,
	AX5043_FREQDEV11,
	AX5043_FREQDEV01,
	AX5043_FOURFSK1,
	AX5043_BBOFFSRES1,
	//	Receiver Parameter Set 2
	AX5043_AGCGAIN2 = 0x0140,
	AX5043_AGCTARGET2,
	AX5043_AGCAHYST2,
	AX5043_AGCMINMAX2,
	AX5043_TIMEGAIN2,
	AX5043_DRGAIN2,
	AX5043_PHASEGAIN2,
	AX5043_FREQUENCYGAINA2,
	AX5043_FREQUENCYGAINB2,
	AX5043_FREQUENCYGAINC2,
	AX5043_FREQUENCYGAIND2,
	AX5043_AMPLITUDEGAIN2,
	AX5043_FREQDEV12,
	AX5043_FREQDEV02,
	AX5043_FOURFSK2,
	AX5043_BBOFFSRES2,
	//	Receiver Parameter Set 3
	AX5043_AGCGAIN3 = 0x0150,
	AX5043_AGCTARGET3,
	AX5043_AGCAHYST3,
	AX5043_AGCMINMAX3,
	AX5043_TIMEGAIN3,
	AX5043_DRGAIN3,
	AX5043_PHASEGAIN3,
	AX5043_FREQUENCYGAINA3,
	AX5043_FREQUENCYGAINB3,
	AX5043_FREQUENCYGAINC3,
	AX5043_FREQUENCYGAIND3,
	AX5043_AMPLITUDEGAIN3,
	AX5043_FREQDEV13,
	AX5043_FREQDEV03,
	AX5043_FOURFSK3,
	AX5043_BBOFFSRES3,
	//	Transmitter Parameters
	AX5043_MODCFGF = 0x0160,
	AX5043_FSKDEV2,
	AX5043_FSKDEV1,
	AX5043_FSKDEV0,
	AX5043_MODCFGA,
	AX5043_TXRATE2,
	AX5043_TXRATE1,
	AX5043_TXRATE0,
	AX5043_TXPWRCOEFFA1,
	AX5043_TXPWRCOEFFA0,
	AX5043_TXPWRCOEFFB1,
	AX5043_TXPWRCOEFFB0,
	AX5043_TXPWRCOEFFC1,
	AX5043_TXPWRCOEFFC0,
	AX5043_TXPWRCOEFFD1,
	AX5043_TXPWRCOEFFD0,
	AX5043_TXPWRCOEFFE1,
	AX5043_TXPWRCOEFFE0,
	//	PLL Parameters
	AX5043_PLLVCOI = 0x0180,
	AX5043_PLLVCOIR,
	AX5043_PLLLOCKDET,
	AX5043_PLLRNGCLK,
	//	Crystal Oscillator
	AX5043_XTALCAP = 0x0184,
	//	Baseband
	AX5043_BBTUNE = 0x00188,
	AX5043_BBOFFSCAP,
	//	MAC Layer Parameters
	//	Packet Format
	AX5043_PKTADDRCFG = 0x0200,
	AX5043_PKTLENCFG,
	AX5043_PKTLENOFFSET,
	AX5043_PKTMAXLEN,
	AX5043_PKTADDR3,
	AX5043_PKTADDR2,
	AX5043_PKTADDR1,
	AX5043_PKTADDR0,
	AX5043_PKTADDRMASK3,
	AX5043_PKTADDRMASK2,
	AX5043_PKTADDRMASK1,
	AX5043_PKTADDRMASK0,
	//	Pattern Match
	AX5043_MATCH0PAT3 = 0x0210,
	AX5043_MATCH0PAT2,
	AX5043_MATCH0PAT1,
	AX5043_MATCH0PAT0,
	AX5043_MATCH0LEN,
	AX5043_MATCH0MIN,
	AX5043_MATCH0MAX,
	AX5043_MATCH1PAT1 = 0x0218,
	AX5043_MATCH1PAT0,
	AX5043_MATCH1LEN = 0x021C,
	AX5043_MATCH1MIN,
	AX5043_MATCH1MAX,
	//	Packet Controller
	AX5043_TMGTXBOOST = 0x0220,
	AX5043_TMGTXSETTLE,
	AX5043_TMGRXBOOST = 0x0223,
	AX5043_TMGRXSETTLE,
	AX5043_TMGRXOFFSACQ,
	AX5043_TMGRXCOARSEAGC,
	AX5043_TMGRXAGC,
	AX5043_TMGRXRSSI,
	AX5043_TMGRXPREAMBLE1,
	AX5043_TMGRXPREAMBLE2,
	AX5043_TMGRXPREAMBLE3,
	AX5043_RSSIREFERENCE,
	AX5043_RSSIABSTHR,
	AX5043_BGNDRSSIGAIN,
	AX5043_BGNDRSSITHR,
	AX5043_PKTCHUNKSIZE,
	AX5043_PKTMISCFLAGS,
	AX5043_PKTSTOREFLAGS,
	AX5043_PKTACCEPTFLAGS,
	//	Special Functions
	//	General Purpose ADC
	AX5043_GPADCCTRL = 0x0300,
	AX5043_GPADCPERIOD,
	AX5043_GPADC13VALUE1 = 0x308,
	AX5043_GPADC13VALUE0,
	//	Low Power Oscillator Calibration
	AX5043_LPOSCCONFIG = 0x0310,
	AX5043_LPOSCSTATUS,
	AX5043_LPOSCKFILT1,
	AX5043_LPOSCKFILT0,
	AX5043_LPOSCREF1,
	AX5043_LPOSCREF0,
	AX5043_LPOSCFREQ1,
	AX5043_LPOSCFREQ0,
	AX5043_LPOSCPER1,
	AX5043_LPOSCPER0,
	//	DAC
	AX5043_DACVALUE0 = 0x0330,
	AX5043_DACVALUE1,
	AX5043_DACCONFIG,
	//	Performance Tuning Registers
	AX5043_0xF00 = 0x0F00,
	AX5043_0xF0C = 0x0F0C,
	AX5043_0xF10 = 0x0F10,
	AX5043_0xF11 = 0x0F11,
	AX5043_0xF18 = 0x0F18,
	AX5043_0xF1C = 0x0F1C,
	AX5043_0xF21 = 0x0F21,
	AX5043_0xF22 = 0x0F22,
	AX5043_0xF23 = 0x0F23,
	AX5043_0xF26 = 0x0F26,
	AX5043_0xF30 = 0x0F30,
	AX5043_0xF31 = 0x0F31,
	AX5043_0xF32 = 0x0F32,
	AX5043_0xF33 = 0x0F33,
	AX5043_0xF34 = 0x0F34,
	AX5043_0xF35 = 0x0F35,
	AX5043_0xF44 = 0x0F44,

	AX5043_REF = 0x0F0D,
	AX5043_POWCTRL1 = 0x0F08,
	AX5043_MODCFGP = 0x0F5F,
	AX5043_XTALOSC = 0x0F10,
	AX5043_XTALAMPL = 0x0F11,
};

enum ax5043_func_name_t
{
    AXRADIO_ENABLE_GLOBAL_IRQ = 0,
	AXRADIO_DISABLE_GLOBAL_IRQ,
	AXRADIO_ENABLE_IRQ_PIN,
	AXRADIO_DISABLE_IRQ_PIN,
	AXRADIO_GET_IRQ_PIN,
	AXRADIO_SPI_RX,
	AXRADIO_SPI_TX,
	AXRADIO_SPI_TX_RX,
	AXRADIO_SPI_CS_WRITE,
	AXRADIO_STATUSCHANGE,
    AXRADIO_ON_OFF_PWR
};

#define SILICONREV1 			0x51

#define RADIO_OK                0
#define RADIO_ERR_REVISION      1
#define RADIO_ERR_COMM          2
#define RADIO_ERR_IRQ           3
#define RADIO_ERR_WAKEUPTIMEOUT 4

void ax5043_reg_func(uint8_t name, void * fn);

uint8_t ax5043_spi_write(uint32_t add, uint8_t data);
uint8_t ax5043_spi_read(uint32_t add);
uint16_t ax5043_spi_read16(uint32_t add);
uint32_t ax5043_spi_read24(uint32_t add);
void ax5043_spi_write_fifo(uint8_t *ptr, uint8_t len);
void ax5043_spi_read_fifo(uint8_t *ptr, uint8_t len);

uint8_t ax5043_wakeup_deepsleep(void);
uint8_t ax5043_wakeup_deepsleep_core(void);
void ax5043_enter_deepsleep(void);

uint8_t ax5043_reset(void);
uint8_t ax5043_probeirq(void);

void ax5043_tcxo_set_reset(uint8_t set);
void ax5043_hard_reset();


#endif /* AXRADIO_AX5043_H_ */
